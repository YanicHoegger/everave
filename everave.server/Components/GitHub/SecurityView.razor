@inject IGitHubAccess GitHubAccess

<h3>Vulnerable Dependencies</h3>

@if (alerts == null)
{
    <p>Loading...</p>
}
else if (!alerts.Any())
{
    <p>✅ No known vulnerabilities</p>
}
else
{
    <table>
        <thead>
        <tr><th>Package</th><th>Severity</th><th>Current</th><th>Fixed</th><th>Details</th></tr>
        </thead>
        <tbody>
        @foreach (var alert in alerts)
        {
            <tr>
                <td>@alert.PackageName</td>
                <td>@alert.Severity</td>
                <td>@alert.CurrentVersion</td>
                <td>@alert.FixedVersion</td>
                <td><a href="@alert.AdvisoryUrl" target="_blank">View</a></td>
            </tr>
        }
        </tbody>
    </table>
}

@code {
    private List<DependabotAlert>? alerts;

    protected override async Task OnInitializedAsync()
    {
        alerts = await GitHubAccess.GetDependabotAlertsAsync();
    }
}