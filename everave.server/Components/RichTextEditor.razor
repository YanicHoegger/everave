@inject IJSRuntime JS
@implements IDisposable

<div>
    <div id="@EditorId"></div>
</div>

@code {
    [Parameter] public string EditorId { get; set; } = $"editor_{Guid.NewGuid()}";
    [Parameter] public string? Value { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }

    private IJSObjectReference? _module;
    private DotNetObjectReference<RichTextEditor>? _dotNetRef;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            _dotNetRef = DotNetObjectReference.Create(this);
            await JS.InvokeVoidAsync("EditorLib.InitializeEditor", EditorId, _dotNetRef);
        }
    }

    [JSInvokable]
    public async Task OnEditorDataChanged(string data)
    {
        Value = data;
        await ValueChanged.InvokeAsync(data);
    }

    public void Dispose()
    {
        _dotNetRef?.Dispose();
    }
}
